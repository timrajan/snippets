Backend API Verification Request: Test Report Sync Endpoints                                                                                                                                                   
                                                                                                                                                                                                                 
  Context                                                                                                                                                                                                        
                                                                                                                                                                                                                 
  We have implemented client-side functionality to sync test execution reports to the server. This includes:                                                                                                     
  - Suite run metadata                                                                                                                                                                                           
  - Test case results                                                                                                                                                                                            
  - Step results (individual test steps with status, duration, error messages)                                                                                                                                   
  - Screenshots/Artifacts (images captured during test execution)                                                                                                                                                
  - Checkpoint results                                                                                                                                                                                           
  - Console and network logs                                                                                                                                                                                     
                                                                                                                                                                                                                 
  The client is successfully creating suite runs and test case results, but steps and screenshots are not appearing when retrieved from the server. We need to verify if the following endpoints are implemented 
  and working correctly.                                                                                                                                                                                         
                                                                                                                                                                                                                 
  ---                                                                                                                                                                                                            
  Required Endpoints to Verify                                                                                                                                                                                   
                                                                                                                                                                                                                 
  1. Bulk Create Step Results                                                                                                                                                                                    
                                                                                                                                                                                                                 
  Endpoint: POST /api/v1/reports/test-case-results/{test_case_id}/steps/bulk                                                                                                                                     
                                                                                                                                                                                                                 
  Purpose: Create multiple step results for a test case in a single request.                                                                                                                                     
                                                                                                                                                                                                                 
  Request Body:                                                                                                                                                                                                  
  {                                                                                                                                                                                                              
    "steps": [                                                                                                                                                                                                   
      {                                                                                                                                                                                                          
        "step_number": 1,                                                                                                                                                                                        
        "action": "navigate",                                                                                                                                                                                    
        "description": "Navigate to https://example.com",                                                                                                                                                        
        "status": "Passed",                                                                                                                                                                                      
        "duration_ms": 1500,                                                                                                                                                                                     
        "error_message": null,                                                                                                                                                                                   
        "screenshot_path": "step_001.png"                                                                                                                                                                        
      },                                                                                                                                                                                                         
      {                                                                                                                                                                                                          
        "step_number": 2,                                                                                                                                                                                        
        "action": "click",                                                                                                                                                                                       
        "description": "Click on Login button",                                                                                                                                                                  
        "status": "Passed",                                                                                                                                                                                      
        "duration_ms": 250,                                                                                                                                                                                      
        "error_message": null,                                                                                                                                                                                   
        "screenshot_path": "step_002.png"                                                                                                                                                                        
      },                                                                                                                                                                                                         
      {                                                                                                                                                                                                          
        "step_number": 3,                                                                                                                                                                                        
        "action": "fill",                                                                                                                                                                                        
        "description": "Enter username",                                                                                                                                                                         
        "status": "Failed",                                                                                                                                                                                      
        "duration_ms": 100,                                                                                                                                                                                      
        "error_message": "Element not found: #username",                                                                                                                                                         
        "screenshot_path": "step_003.png"                                                                                                                                                                        
      }                                                                                                                                                                                                          
    ]                                                                                                                                                                                                            
  }                                                                                                                                                                                                              
                                                                                                                                                                                                                 
  Expected Response (201 Created):                                                                                                                                                                               
  {                                                                                                                                                                                                              
    "created": 3,                                                                                                                                                                                                
    "steps": [                                                                                                                                                                                                   
      {                                                                                                                                                                                                          
        "id": "uuid-step-1",                                                                                                                                                                                     
        "test_case_result_id": "uuid-test-case",                                                                                                                                                                 
        "step_number": 1,                                                                                                                                                                                        
        "action": "navigate",                                                                                                                                                                                    
        "description": "Navigate to https://example.com",                                                                                                                                                        
        "status": "Passed",                                                                                                                                                                                      
        "duration_ms": 1500,                                                                                                                                                                                     
        "error_message": null,                                                                                                                                                                                   
        "screenshot_path": "step_001.png",                                                                                                                                                                       
        "created_at": "2026-01-24T12:00:00Z"                                                                                                                                                                     
      },                                                                                                                                                                                                         
      ...                                                                                                                                                                                                        
    ]                                                                                                                                                                                                            
  }                                                                                                                                                                                                              
                                                                                                                                                                                                                 
  Questions:                                                                                                                                                                                                     
  - Is this endpoint implemented?                                                                                                                                                                                
  - What is the database table name for step results? (e.g., test_step_results)                                                                                                                                  
  - Are steps being persisted to the database?                                                                                                                                                                   
                                                                                                                                                                                                                 
  ---                                                                                                                                                                                                            
  2. Upload Artifact (Screenshot)                                                                                                                                                                                
                                                                                                                                                                                                                 
  Endpoint: POST /api/v1/reports/test-case-results/{test_case_id}/artifacts                                                                                                                                      
                                                                                                                                                                                                                 
  Purpose: Upload a screenshot or other file artifact for a test case.                                                                                                                                           
                                                                                                                                                                                                                 
  Request: multipart/form-data                                                                                                                                                                                   
                                                                                                                                                                                                                 
  Form Fields:                                                                                                                                                                                                   
  ┌───────────────────┬─────────┬──────────┬────────────────────────────────────────────┐                                                                                                                        
  │       Field       │  Type   │ Required │                Description                 │                                                                                                                        
  ├───────────────────┼─────────┼──────────┼────────────────────────────────────────────┤                                                                                                                        
  │ file              │ File    │ Yes      │ The image/file to upload                   │                                                                                                                        
  ├───────────────────┼─────────┼──────────┼────────────────────────────────────────────┤                                                                                                                        
  │ artifact_type     │ String  │ Yes      │ Type: screenshot, log, video, other        │                                                                                                                        
  ├───────────────────┼─────────┼──────────┼────────────────────────────────────────────┤                                                                                                                        
  │ step_number       │ Integer │ No       │ Which step this artifact belongs to        │                                                                                                                        
  ├───────────────────┼─────────┼──────────┼────────────────────────────────────────────┤                                                                                                                        
  │ iteration_number  │ Integer │ No       │ For data-driven tests (default: 1)         │                                                                                                                        
  ├───────────────────┼─────────┼──────────┼────────────────────────────────────────────┤                                                                                                                        
  │ artifact_category │ String  │ No       │ Category: before, after, error, checkpoint │                                                                                                                        
  ├───────────────────┼─────────┼──────────┼────────────────────────────────────────────┤                                                                                                                        
  │ description       │ String  │ No       │ Human-readable description                 │                                                                                                                        
  ├───────────────────┼─────────┼──────────┼────────────────────────────────────────────┤                                                                                                                        
  │ captured_at       │ String  │ No       │ ISO timestamp when captured                │                                                                                                                        
  └───────────────────┴─────────┴──────────┴────────────────────────────────────────────┘                                                                                                                        
  Expected Response (201 Created):                                                                                                                                                                               
  {                                                                                                                                                                                                              
    "id": "uuid-artifact",                                                                                                                                                                                       
    "test_case_result_id": "uuid-test-case",                                                                                                                                                                     
    "artifact_type": "screenshot",                                                                                                                                                                               
    "step_number": 1,                                                                                                                                                                                            
    "file_name": "step_001.png",                                                                                                                                                                                 
    "file_size": 125000,                                                                                                                                                                                         
    "mime_type": "image/png",                                                                                                                                                                                    
    "storage_path": "/artifacts/2026/01/24/uuid-artifact.png",                                                                                                                                                   
    "download_url": "/api/v1/reports/artifacts/uuid-artifact/download",                                                                                                                                          
    "created_at": "2026-01-24T12:00:00Z"                                                                                                                                                                         
  }                                                                                                                                                                                                              
                                                                                                                                                                                                                 
  Questions:                                                                                                                                                                                                     
  - Is this endpoint implemented?                                                                                                                                                                                
  - Where are files being stored? (Local filesystem? Cloud storage?)                                                                                                                                             
  - What is the database table name for artifacts? (e.g., test_artifacts)                                                                                                                                        
  - Is the download_url being generated correctly?                                                                                                                                                               
                                                                                                                                                                                                                 
  ---                                                                                                                                                                                                            
  3. Get Steps for Test Case                                                                                                                                                                                     
                                                                                                                                                                                                                 
  Endpoint: GET /api/v1/reports/test-case-results/{test_case_id}/steps                                                                                                                                           
                                                                                                                                                                                                                 
  Purpose: Retrieve all step results for a test case.                                                                                                                                                            
                                                                                                                                                                                                                 
  Query Parameters:                                                                                                                                                                                              
  ┌───────────────────┬─────────┬───────────────────────────────────┐                                                                                                                                            
  │     Parameter     │  Type   │            Description            │                                                                                                                                            
  ├───────────────────┼─────────┼───────────────────────────────────┤                                                                                                                                            
  │ include_artifacts │ Boolean │ Include artifact URLs in response │                                                                                                                                            
  └───────────────────┴─────────┴───────────────────────────────────┘                                                                                                                                            
  Expected Response (200 OK):                                                                                                                                                                                    
  [                                                                                                                                                                                                              
    {                                                                                                                                                                                                            
      "id": "uuid-step-1",                                                                                                                                                                                       
      "test_case_result_id": "uuid-test-case",                                                                                                                                                                   
      "step_number": 1,                                                                                                                                                                                          
      "action": "navigate",                                                                                                                                                                                      
      "description": "Navigate to https://example.com",                                                                                                                                                          
      "status": "Passed",                                                                                                                                                                                        
      "duration_ms": 1500,                                                                                                                                                                                       
      "error_message": null,                                                                                                                                                                                     
      "screenshot_artifact_id": "uuid-artifact-1",                                                                                                                                                               
      "artifacts": [                                                                                                                                                                                             
        {                                                                                                                                                                                                        
          "id": "uuid-artifact-1",                                                                                                                                                                               
          "artifact_type": "screenshot",                                                                                                                                                                         
          "download_url": "/api/v1/reports/artifacts/uuid-artifact-1/download"                                                                                                                                   
        }                                                                                                                                                                                                        
      ]                                                                                                                                                                                                          
    },                                                                                                                                                                                                           
    ...                                                                                                                                                                                                          
  ]                                                                                                                                                                                                              
                                                                                                                                                                                                                 
  Current Behavior: Returns empty array [] even after steps have been created.                                                                                                                                   
                                                                                                                                                                                                                 
  ---                                                                                                                                                                                                            
  4. Get Artifacts for Test Case                                                                                                                                                                                 
                                                                                                                                                                                                                 
  Endpoint: GET /api/v1/reports/test-case-results/{test_case_id}/artifacts                                                                                                                                       
                                                                                                                                                                                                                 
  Purpose: Retrieve all artifacts for a test case.                                                                                                                                                               
                                                                                                                                                                                                                 
  Expected Response (200 OK):                                                                                                                                                                                    
  [                                                                                                                                                                                                              
    {                                                                                                                                                                                                            
      "id": "uuid-artifact",                                                                                                                                                                                     
      "test_case_result_id": "uuid-test-case",                                                                                                                                                                   
      "artifact_type": "screenshot",                                                                                                                                                                             
      "step_number": 1,                                                                                                                                                                                          
      "file_name": "step_001.png",                                                                                                                                                                               
      "file_size": 125000,                                                                                                                                                                                       
      "mime_type": "image/png",                                                                                                                                                                                  
      "download_url": "/api/v1/reports/artifacts/uuid-artifact/download",                                                                                                                                        
      "created_at": "2026-01-24T12:00:00Z"                                                                                                                                                                       
    },                                                                                                                                                                                                           
    ...                                                                                                                                                                                                          
  ]                                                                                                                                                                                                              
                                                                                                                                                                                                                 
  Current Behavior: Returns empty array [] even after artifacts have been uploaded.                                                                                                                              
                                                                                                                                                                                                                 
  ---                                                                                                                                                                                                            
  5. Download Artifact                                                                                                                                                                                           
                                                                                                                                                                                                                 
  Endpoint: GET /api/v1/reports/artifacts/{artifact_id}/download                                                                                                                                                 
                                                                                                                                                                                                                 
  Purpose: Download the actual file content.                                                                                                                                                                     
                                                                                                                                                                                                                 
  Expected Response: Binary file content with appropriate Content-Type header.                                                                                                                                   
                                                                                                                                                                                                                 
  ---                                                                                                                                                                                                            
  Database Schema Verification                                                                                                                                                                                   
                                                                                                                                                                                                                 
  Please confirm these tables exist and have the correct structure:                                                                                                                                              
                                                                                                                                                                                                                 
  Table: test_step_results                                                                                                                                                                                       
                                                                                                                                                                                                                 
  CREATE TABLE test_step_results (                                                                                                                                                                               
      id UUID PRIMARY KEY,                                                                                                                                                                                       
      test_case_result_id UUID REFERENCES test_case_results(id) ON DELETE CASCADE,                                                                                                                               
      step_number INTEGER NOT NULL,                                                                                                                                                                              
      action VARCHAR(100),                                                                                                                                                                                       
      description TEXT,                                                                                                                                                                                          
      status VARCHAR(20) NOT NULL,  -- Passed, Failed, Skipped                                                                                                                                                   
      duration_ms INTEGER,                                                                                                                                                                                       
      error_message TEXT,                                                                                                                                                                                        
      screenshot_path VARCHAR(500),                                                                                                                                                                              
      screenshot_artifact_id UUID REFERENCES test_artifacts(id),                                                                                                                                                 
      created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),                                                                                                                                                         
      updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()                                                                                                                                                          
  );                                                                                                                                                                                                             
                                                                                                                                                                                                                 
  Table: test_artifacts                                                                                                                                                                                          
                                                                                                                                                                                                                 
  CREATE TABLE test_artifacts (                                                                                                                                                                                  
      id UUID PRIMARY KEY,                                                                                                                                                                                       
      test_case_result_id UUID REFERENCES test_case_results(id) ON DELETE CASCADE,                                                                                                                               
      step_result_id UUID REFERENCES test_step_results(id),                                                                                                                                                      
      artifact_type VARCHAR(50) NOT NULL,  -- screenshot, log, video, other                                                                                                                                      
      artifact_category VARCHAR(50),  -- before, after, error, checkpoint                                                                                                                                        
      step_number INTEGER,                                                                                                                                                                                       
      iteration_number INTEGER DEFAULT 1,                                                                                                                                                                        
      file_name VARCHAR(255) NOT NULL,                                                                                                                                                                           
      file_size INTEGER,                                                                                                                                                                                         
      mime_type VARCHAR(100),                                                                                                                                                                                    
      storage_path VARCHAR(500) NOT NULL,                                                                                                                                                                        
      description TEXT,                                                                                                                                                                                          
      captured_at TIMESTAMP WITH TIME ZONE,                                                                                                                                                                      
      created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()                                                                                                                                                          
  );                                                                                                                                                                                                             
                                                                                                                                                                                                                 
  ---                                                                                                                                                                                                            
  Test Verification Steps                                                                                                                                                                                        
                                                                                                                                                                                                                 
  Please run these tests to verify the endpoints work:                                                                                                                                                           
                                                                                                                                                                                                                 
  1. Create a test case result (this already works):                                                                                                                                                             
  POST /api/v1/reports/suite-runs/{suite_id}/test-cases                                                                                                                                                          
  2. Bulk create steps for that test case:                                                                                                                                                                       
  POST /api/v1/reports/test-case-results/{test_case_id}/steps/bulk                                                                                                                                               
  2. Verify response includes created steps with IDs.                                                                                                                                                            
  3. Upload a screenshot:                                                                                                                                                                                        
  POST /api/v1/reports/test-case-results/{test_case_id}/artifacts                                                                                                                                                
  3. Verify response includes artifact ID and download URL.                                                                                                                                                      
  4. Retrieve steps:                                                                                                                                                                                             
  GET /api/v1/reports/test-case-results/{test_case_id}/steps                                                                                                                                                     
  4. Verify the steps created in step 2 are returned.                                                                                                                                                            
  5. Retrieve artifacts:                                                                                                                                                                                         
  GET /api/v1/reports/test-case-results/{test_case_id}/artifacts                                                                                                                                                 
  5. Verify the artifact uploaded in step 3 is returned.                                                                                                                                                         
  6. Download artifact:                                                                                                                                                                                          
  GET /api/v1/reports/artifacts/{artifact_id}/download                                                                                                                                                           
  6. Verify the file downloads correctly.                                                                                                                                                                        
                                                                                                                                                                                                                 
  ---                                                                                                                                                                                                            
  Summary of Issues                                                                                                                                                                                              
                                                                                                                                                                                                                 
  The client is calling these endpoints but:                                                                                                                                                                     
  - GET .../steps returns [] (empty)                                                                                                                                                                             
  - GET .../artifacts returns [] (empty)                                                                                                                                                                         
                                                                                                                                                                                                                 
  We need to confirm:                                                                                                                                                                                            
  1. Are the POST endpoints (bulk steps, upload artifact) implemented and saving data?                                                                                                                           
  2. Are the GET endpoints querying the correct tables?                                                                                                                                                          
  3. Are there any errors in the server logs when these endpoints are called?                                                                                                                                    
                                                                                                                                                                                                                 
  Please provide:                                                                                                                                                                                                
  - Confirmation of which endpoints are implemented                                                                                                                                                              
  - Any server-side error logs                                                                                                                                                                                   
  - Database query results showing if data exists in test_step_results and test_artifacts tables    
